<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .container {
            display: flex;
            width: 500px;
            margin: 0 auto;
            gap: 20px;
        }

        select {
            flex: 1;
            width: 100%;
            height: 30px;
            border: 1px solid #eee;
        }
    </style>
</head>
<body>
<div class="container">
    <select id="province">
        <option value="">请选择</option>
    </select>
    <select id="city">
        <option value="">请选择</option>
    </select>
    <select id="area">
        <option value="">请选择</option>
    </select>
</div>
<a href="p2.html">跳转到p2</a>
<script>
    const sourceData = [
        {id: 1, type: "province", displayName: "广东省", parentId: null},
        {id: 2, type: "province", displayName: "广西省", parentId: null},

        {id: 3, type: "city", displayName: "东莞市", parentId: 1},
        {id: 4, type: "city", displayName: "广州市", parentId: 1},
        {id: 5, type: "city", displayName: "深圳市", parentId: 1},
        {id: 6, type: "city", displayName: "南宁", parentId: 2},
        {id: 7, type: "city", displayName: "玉林", parentId: 2},

        {id: 8, type: "area", displayName: "松山湖片区", parentId: 3},
        {id: 9, type: "area", displayName: "东部产业园", parentId: 3},
        {id: 10, type: "area", displayName: "滨海区", parentId: 3},
        {id: 11, type: "area", displayName: "天河区", parentId: 4},
        {id: 12, type: "area", displayName: "番禺区", parentId: 4},
        {id: 13, type: "area", displayName: "宝安区", parentId: 5},
        {id: 14, type: "area", displayName: "南山区", parentId: 5},
        {id: 15, type: "area", displayName: "兴宁区", parentId: 6},
        {id: 16, type: "area", displayName: "玉州区", parentId: 7},
    ];

    /**
     * 查找下属地区
     * @param parentId {string | number | null} 父级地区ID
     * @return {array} 返回下属地区集合
     * */
    function findArea(parentId) {
        return sourceData.filter(item => item.parentId == parentId)
    }

    /**
     * 替换option数据
     * @param container {HTMLElement | Element}
     * @param areaData {array} 地区数据
     * */
    function changeOptions(container, areaData) {
        container.innerHTML = areaData.reduce((a, b) => {
            const {displayName, parentId, id} = b
            a += `<option value="${id}" data-parentId="${parentId}">${displayName}</option>`
            return a
        }, '<option>请选择</option>')
    }

    const selectCons = document.querySelectorAll('select')
    selectCons.forEach(select => {
        let areaData = []
        if (select.id === 'province') {
            areaData = findArea(null)
            changeOptions(select, areaData)
        }
        select.addEventListener('change', e => {
            let {value} = e.target
            let next = select.nextElementSibling
            while (!!next) {
                areaData = findArea(value)
                changeOptions(next, areaData)
                next = next.nextElementSibling
                value = ''
            }
        })
    })

</script>
</body>
</html>
